facet_wrap(~pseq,scales = "free_y",labeller = labeller(Stock))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = labeller(Stock=Stock))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
mylab <- list(df$pseq = df$Stock)
mylab <- list(`df$pseq` = df$Stock)
View(mylab)
mylab <- list(`1` = df$Stock[1])
View(mylab)
mylab <- list(`1` = df$Stock[1],`2` = df$Stock[2],`3` = df$Stock[3],`4` = df$Stock[4],
`5` = df$Stock[5],`6` = df$Stock[6],`7` = df$Stock[7],`8` = df$Stock[8],
`9` = df$Stock[9],`10` = df$Stock[10],`11` = df$Stock[11],`12` = df$Stock[12],
`13` = df$Stock[13],`14` = df$Stock[14],`15` = df$Stock[15],`16` = df$Stock[16],
`17` = df$Stock[17],`18` = df$Stock[18])
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = labeller(Stock=mylab))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 6, w = 11)
View(mylab)
View(mylab)
View(df)
View(fc)
View(fc_pop)
pname
mylab <- list(`1` = pname[1],`2` = pname[2],`3` = pname[3],`4` = pname[4],
`5` = pname[5],`6` = pname[6],`7` = pname[7],`8` = pname[8],
`9` = pname[9],`10` = pname[10],`11` = pname[11],`12` = pname[12],
`13` = pname[13],`14` = pname[14],`15` = pname[15],`16` = pname[16],
`17` = pname[17],`18` = pname[18])
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = labeller(mylab))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 6, w = 11)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = mylab)+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
View(mylab)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = pname)+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
mylab <- c(`1` = pname[1],`2` = pname[2],`3` = pname[3],`4` = pname[4],
`5` = pname[5],`6` = pname[6],`7` = pname[7],`8` = pname[8],
`9` = pname[9],`10` = pname[10],`11` = pname[11],`12` = pname[12],
`13` = pname[13],`14` = pname[14],`15` = pname[15],`16` = pname[16],
`17` = pname[17],`18` = pname[18])
mylab <- labeller(pseq = list(`1` = pname[1],`2` = pname[2],`3` = pname[3],`4` = pname[4],
`5` = pname[5],`6` = pname[6],`7` = pname[7],`8` = pname[8],
`9` = pname[9],`10` = pname[10],`11` = pname[11],`12` = pname[12],
`13` = pname[13],`14` = pname[14],`15` = pname[15],`16` = pname[16],
`17` = pname[17],`18` = pname[18]))
mylab <- labeller(pseq = list(`1` = pname[1],`2` = pname[2],`3` = pname[3],`4` = pname[4],
`5` = pname[5],`6` = pname[6],`7` = pname[7],`8` = pname[8],
`9` = pname[9],`10` = pname[10],`11` = pname[11],`12` = pname[12],
`13` = pname[13],`14` = pname[14],`15` = pname[15],`16` = pname[16],
`17` = pname[17],`18` = pname[18]))
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = mylab) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
View(mylab)
mylab <- as_labeller(c(`1` = pname[1],`2` = pname[2],`3` = pname[3],`4` = pname[4],
`5` = pname[5],`6` = pname[6],`7` = pname[7],`8` = pname[8],
`9` = pname[9],`10` = pname[10],`11` = pname[11],`12` = pname[12],
`13` = pname[13],`14` = pname[14],`15` = pname[15],`16` = pname[16],
`17` = pname[17],`18` = pname[18]))
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y",labeller = mylab) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~Stock,scales = "free_y",labeller = mylab) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~Stock,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts_ref.png", h = 6, w = 11)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~pseq,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
df<- fc %>%
filter(popID <= 18) %>%
mutate(pseq = rep(pseq,each = 12)) %>%
select(retyr,Stock,pseq,popID,fc,tot) %>%
pivot_longer(cols = c("fc","tot"),names_to = "return",values_to = "model")
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
fc <- read_csv("../data/historical_fc.csv",show_col_types = FALSE)
pname<-unique(fc$Stock)
pseq <- c(1,4,14,15,17,18,8,16,7,6,2,3,5,9,11,12,13,10)
pnew <-pname[pseq]
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y",labeller = labeller(popID = as_labeller(pnew))) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
View(df)
str(df)
df$Stock <- factor(df$Stock, levels = pnew)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y",labeller = labeller(popID = as_labeller(pnew))) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y",labeller = labeller(popID = as_labeller(pnew))) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~popID,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~Stock,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~Stock,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))+
modify_facet_appearance(strip.text.x.col = "red")
p1
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Total")+
facet_wrap(~Stock,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 6, w = 11)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Numbers of Sockeye Salmon")+
facet_wrap(~Stock,scales = "free_y") +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 6, w = 11)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = c(.9, 0.07),axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Numbers of Sockeye Salmon")+
facet_wrap(~Stock,scales = "free_y",ncol = 4) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 8, w = 11)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = "bottom",axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Numbers of Sockeye Salmon")+
facet_wrap(~Stock,scales = "free_y",ncol = 3) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 8, w = 11)
ggsave("../plot/plot_ts.png", h = 11, w = 8)
ggsave("../plot/plot_ts.png", h = 9, w = 8)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+theme(legend.justification = "bottom")+
theme(legend.position = "bottom",axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Numbers of Sockeye Salmon")+xlab("Year")+
facet_wrap(~Stock,scales = "free_y",ncol = 3) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 9, w = 8)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+
theme(legend.position = "bottom",axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
ylab("Numbers of Sockeye Salmon")+
xlab("Year")+
facet_wrap(~Stock,scales = "free_y",ncol = 3) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE))
p1
ggsave("../plot/plot_ts.png", h = 15, w = 8)
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+
theme(legend.position = "bottom",axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +
facet_wrap(~Stock,scales = "free_y",ncol = 3) +
ylab("Numbers of Sockeye Salmon")+
xlab("Year")
p1<-ggplot(data = df,
aes(x=retyr,y=model,colour=return))+
geom_point(size=3,alpha = 0.7)+
geom_line(size=1,alpha = 0.7)+
theme_bw(base_size = 12)+
theme(legend.position = "bottom",#axis.title.x=element_blank(),
legend.background  = element_blank(),
legend.text=element_text(size=16))+
scale_colour_manual(name="",values=c("red","blue"),
labels=c("Forecast","Observation"))+
scale_x_continuous(breaks=seq(2010,2020,by=5),
minor_breaks = 2009:2020,
labels=seq(2010,2020,by=5))+
scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +
facet_wrap(~Stock,scales = "free_y",ncol = 3) +
ylab("Numbers of Sockeye Salmon")+
xlab("Year")
p1
ggsave("../plot/plot_ts.png", h = 9, w = 8)
